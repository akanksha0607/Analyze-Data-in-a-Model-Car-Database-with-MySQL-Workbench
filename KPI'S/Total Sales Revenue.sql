-- revune generated by each warehouse.
SELECT
    w.warehouseCode,
    SUM(od.priceEach * od.quantityOrdered) AS TotalRevenue
FROM
    warehouses w
LEFT JOIN
    products p ON w.warehouseCode = p.warehouseCode
LEFT JOIN
    orderdetails od ON p.productCode = od.productCode
GROUP BY
    w.warehouseCode, w.warehouseName;

-- revune generated by each warehouse and each productline.
SELECT
    w.warehouseCode, p.productline,
    SUM(od.priceEach * od.quantityOrdered) AS TotalRevenue
FROM
    warehouses w
LEFT JOIN
    products p ON w.warehouseCode = p.warehouseCode
LEFT JOIN
    orderdetails od ON p.productCode = od.productCode
GROUP BY
    w.warehouseCode, p.productline
ORDER BY 
    w.warehouseCode, p.productline;
